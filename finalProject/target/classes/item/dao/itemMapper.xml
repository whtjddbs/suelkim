<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="itemSQL">
 	<!--  왼쪽 카테고리 가져오기 -->
 	<select id="getCategory" resultType="item">
 		select distinct main_codename from item
 	</select>
 	
 	<select id="getImageList" parameterType="java.util.Map" resultType="item">
 		select * from item 
 		where main_codename=#{main_codename} AND rownum &lt;=5 order by seq desc
 	</select>
 	
 	<select id="getItemList" resultType="item">
		select distinct main_codename from item
 	</select>
 	
 	<select id="getInfoList" parameterType="java.util.Map" resultType="item">
 		select * from
		(select rownum rn, tt.*from
		(select * from item 
		where main_codename=#{main_codename} and sub_codename like '%${sub_codename}%'
		order by seq desc)tt
		)where rn between ${startNum} and ${endNum}
 	</select>
 	
 	<select id="getTotalA" parameterType="String" resultType="int">
 		select count(*)from item where main_codename=#{main_codename} and sub_codename like '%${sub_codename}%'
 	</select>
 	
 	<select id="getSubList" parameterType="String" resultType="String">
 		select distinct sub_codename from item where main_codename=#{main_codename}
 	</select>
 
 	<!-- 위시리스트에 담긴 아이템 정보 가져오기 -->
 	<select id="wishList" parameterType="map" resultType="item">
 		select * from
		(select rownum rn, tt.* from (
 		select * from item where seq in (select seq from wishlist where id=#{id}))tt
		)where rn between ${startNum} and ${endNum}
 	</select>
 	
 	<select id="getWishListCount" parameterType="String" resultType="int">
		select count(*) from wishlist where id=#{id}
	</select>
	
	<!-- itemView -->
	<select id="getColor" parameterType="int" resultType="String">
 		select distinct color from item
		join item_info using(seq)
		where seq=#{seq}
 	</select>
 	
 	<select id="getSize1" parameterType="java.util.Map" resultType="String">
		select distinct size1 from item
		join item_info using(seq)
		where seq=${seq} and color=#{color} 
 	</select>
 	
 	<select id="getSize2" parameterType="java.util.Map" resultType="String">
		select distinct size2 from item
		join item_info using(seq)
		where seq=${seq} and color=#{color} and size1=#{size1}
 	</select>
 	
 	<select id="getItemDTO" parameterType="int" resultType="item">
 		select * from item where seq=#{seq}
 	</select>
 	
 	<select id="checkMain_codename" resultType="String">
 		select distinct main_codename from item
 	</select>
 	
 	<select id="checkSub_codename" parameterType="String" resultType="String">
 		select distinct sub_codename from item where main_codename = #{main_codename}
 	</select>
 	
 	<select id="getSerialMapper" parameterType="String" resultType="map">
 		select * from serialmapper
		join item using (seq)
		join buylist using (serial)
 		where serial = #{serial}
 	</select>
 	
 	<!-- 상품 검색 -->
 	<select id="getSearchFormList" parameterType="java.util.Map" resultType="item">
 		select * from 
			(select rownum rn, tt.* from 
			(select * from item where name like '%'||#{name}||'%' order by seq desc)tt
			) where rn <![CDATA[>=]]>#{startNum} and rn <![CDATA[<=]]> #{endNum}
 	</select>
 
 	<!-- main_recommendation 띄우기  -->
 	<select id="getRecommendation" parameterType="String" resultType="item">
 		select * from
		(select rownum rn, tt.*from
		(select * from item 
		 where main_codename=#{main_codename} order by seq desc)tt
		)where rn between 1 and 5
 	</select>
 	
 	<select id="getSearchFormTotalA" parameterType="String" resultType="int">
  		select count(*) from item where name like '%'||#{name}||'%'
  	</select>
 </mapper>